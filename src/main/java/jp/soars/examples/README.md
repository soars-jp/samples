# SOARS Toolkitチュートリアル

## SOARS Toolkitを用いたシミュレータの開発のためのモデリング手順
1. シミュレーションシナリオとシミュレーション条件を記述する．
    - シミュレーションシナリオ
      - 誰が
      - どのような役割（立場）で
      - いつ
      - 何をする（単なる動作だけでなく，時刻（いつ）以外の条件を含んでもよい．）
    - シミュレーション条件
      - 開始時刻
      - 終了時刻
      - 時間ステップ
2. シミュレーションシナリオから，エージェント，スポット，役割を抽出する．
    - エージェントは活動主体である．エージェントは１個以上の役割をもつ．エージェントは，スポットからスポットへと移動する．
    - スポットは場所を表す．スポットには，複数のエージェントが同時に存在できる．スポットは0個以上の役割をもつことができる．
    - 役割は，エージェントの動作を定義する．役割は，１個以上のルールと，ルールを実行するのに必要な０個以上の状態変数から構成される．
3. 以下の２つの制約条件を満たすように，役割をルールに分解し，時刻をステージに分解する．
    - 同一エージェントは，同一時刻，同一ステージに2つ以上のルールを実行することはできない．
    - 同一時刻，同一ステージに実行されるルールは，その実行順序が変わっても結果が変わらない．

### シミュレーションシナリオとシミュレーション条件の記述
シミュレーションシナリオは，以下のことに注意してなるべく詳しく記述する．
- 誰が
- どのような役割（立場）で
- いつ
- 何をする（単なる動作だけでなく，時刻（いつ）以外の条件を含んでもよい．）

シミュレーション条件としては，以下を考える．

### スポットタイプの定義
スポットタイプは，スポット名のベースとなる文字列である．たとえば，スポットタイプをhomeとして，3個のスポットを生成すると，それらのスポット名は，home1, home2, home3となる．ただし，1個しか生成しない場合は，スポット名はスポットタイプと同じになる．たとえば，スポットタイプをcompanyとして，1個のスポットを生成すると，スポット名はcompanyとなる．

### ステージの定義
時間ステップは，(複数の)ステージから構成される．同一時刻の同一ステージに登録されたルールは，順不同で実行され，ユーザがその実行順序を制御することはできない．ここで，ルールはエージェントまたはスポットの振舞を定義したものであり，その詳細は後述する．そのため，ルールの実行順序に依存して実行結果が変わらないように，時間ステップをステージに分解することが重要である．

### 役割とルールの定義

#### 役割
役割は，エージェントまたはスポットの動作と状態を定義するものであり，（複数の）ルールと（複数の）状態変数から構成される．役割には，ルールの追加，ルールの削除，ルールの上書きをすることができる．これにより，既存の役割を修正して再利用することができる．

エージェントは，1個の基本役割と，0個以上の臨時役割を持つ．ただし，同時にアクティブになる役割は1個である．役割の切り替えはルールとして記述する．

ある役割に，他の複数の役割を統合（マージ）することができる．統合元の役割がアクティブになると，統合された役割もアクティブになる．

#### ルール
ルールは，エージェントまたはスポットの振舞を定義したものである．
ルールは，予約された時刻，ステージに実行される．
ユーザは，ルールが実行された際の動作として，別のスポットへの移動（エージェントの場合），ルールが属する役割の状態変数の書き換え，自身または他のルールの実行予約などを記述することができる．
同一時刻の同一ステージに実行されるルールは，順不同で実行され，ユーザがその実行順序を制御することはできないため，注意が必要である．

ルールには，1) 定時実行ルール(regular rule)，2) 臨時実行ルール(temporary rule)の2種類がある．定時実行ルール(regular rule)は，毎日決まった時刻，ステージに実行されるルールであり，hh:mm形式で発火時刻が指定される．臨時実行ルール(temporary rule)は，ある時刻，ステージに１回だけ実行されるルールであり，dd/hh:mm形式で発火時刻が指定される．
